#!/usr/bin/env node

/**
 * Analytics Setup Script
 *
 * This script helps you set up Google Analytics 4 and Google Search Console
 * for your Menteeno website.
 */

const fs = require("fs");
const path = require("path");
const readline = require("readline");

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});

function question(prompt) {
  return new Promise((resolve) => {
    rl.question(prompt, resolve);
  });
}

async function setupAnalytics() {
  console.log("üöÄ Menteeno Analytics Setup\n");

  console.log(
    "This script will help you configure Google Analytics 4 and Google Search Console.\n"
  );

  // Get GA4 Measurement ID
  const gaId = await question("Enter your GA4 Measurement ID (G-XXXXXXXXXX): ");
  if (!gaId.startsWith("G-")) {
    console.log('‚ùå Invalid GA4 ID format. Should start with "G-"');
    process.exit(1);
  }

  // Get GTM ID (optional)
  const gtmId = await question(
    "Enter your Google Tag Manager ID (GTM-XXXXXXX) [optional]: "
  );

  // Get Facebook Pixel ID (optional)
  const fbPixelId = await question("Enter your Facebook Pixel ID [optional]: ");

  // Get Hotjar ID (optional)
  const hotjarId = await question("Enter your Hotjar Site ID [optional]: ");

  // Create environment file content
  const envContent = `# Analytics & Tracking Configuration
# Generated by setup-analytics.js

NEXT_PUBLIC_GA_ID=${gaId}
${gtmId ? `NEXT_PUBLIC_GTM_ID=${gtmId}` : "# NEXT_PUBLIC_GTM_ID="}
${fbPixelId ? `NEXT_PUBLIC_FB_PIXEL_ID=${fbPixelId}` : "# NEXT_PUBLIC_FB_PIXEL_ID="}
${hotjarId ? `NEXT_PUBLIC_HOTJAR_ID=${hotjarId}` : "# NEXT_PUBLIC_HOTJAR_ID="}
`;

  // Write to .env.local
  const envPath = path.join(process.cwd(), ".env.local");
  fs.writeFileSync(envPath, envContent);

  console.log("\n‚úÖ Environment configuration saved to .env.local");

  // Create verification instructions
  const verificationInstructions = `
üìã Next Steps:

1. Google Analytics 4:
   - Your GA4 ID (${gaId}) has been configured
   - Visit your website to test tracking
   - Check GA4 Real-time reports to verify data

2. Google Search Console:
   - Go to https://search.google.com/search-console/
   - Add property: https://menteeno.app
   - Choose verification method:
     * HTML file upload (recommended)
     * HTML meta tag
     * Google Analytics (if GA4 is working)
   - Submit sitemaps:
     * https://menteeno.app/sitemap.xml
     * https://menteeno.app/sitemap-blog.xml
     * https://menteeno.app/sitemap-fa.xml

3. Testing:
   - Run: npm run dev
   - Visit: http://localhost:3000
   - Check browser console for analytics errors
   - Use GA4 DebugView for detailed tracking

4. Production:
   - Set environment variables in your hosting platform
   - Deploy and verify tracking works in production

üìö Documentation: docs/ANALYTICS_SETUP.md
`;

  console.log(verificationInstructions);

  rl.close();
}

// Run the setup
setupAnalytics().catch(console.error);
